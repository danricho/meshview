<!doctype html>
<html lang="en" data-bs-theme="dark">
<head>
    <title>
        Meshview - {{ site_config.get("site", {}).get("title", "") }}
        {% if node and node.short_name %}-- {{ node.short_name }}{% endif %}
    </title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="color-scheme" content="light dark">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>

    <!-- Scripts -->
    <script src="https://unpkg.com/htmx.org@1.9.11" integrity="sha384-0gxUXCCR8yv9FM2b+U3FDbsKthCI66oH5IA9fHppQq9DDMHuMauqq1ZHBpJxQ0J0" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/htmx.org@1.9.11/dist/ext/sse.js" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <style>

        /* ===== Change fonts from Pico defaults ===== */
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@200..1000&display=swap');
        :root{
        --pico-font-family-emoji: "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
        --pico-font-family-sans-serif: "Cairo", sans-serif;
        --pico-font-family-monospace: ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas, "Liberation Mono", monospace, var(--pico-font-family-emoji);
        --pico-font-family: var(--pico-font-family-sans-serif);
        }
        * { font-family: "Cairo", sans-serif; font-optical-sizing: auto; font-variation-settings: "slnt" 0; }

        /* ===== Tweak Pico base sizing ===== */
        :root {
          --pico-form-element-spacing-vertical: 0.25rem;
          --pico-form-element-spacing-horizontal: 0.75rem;
          --pico-spacing: 0.75rem;
          --pico-font-size: 100%;
        }      

        /* ===== breakpoint based hiding ===== */
        .hide { display: none !important; }     
        /* ===== Hide LESS THAN a breakpoint ===== */
        @media (max-width: 575.98px)  { .hide-lt-sm  { display: none !important; } }
        @media (max-width: 767.98px)  { .hide-lt-md  { display: none !important; } }
        @media (max-width: 1023.98px) { .hide-lt-lg  { display: none !important; } }
        @media (max-width: 1279.98px) { .hide-lt-xl  { display: none !important; } }
        @media (max-width: 1535.98px) { .hide-lt-xxl { display: none !important; } }
        /* ===== Hide GREATER THAN a breakpoint ===== */
        @media (min-width: 576px)   { .hide-gte-xs  { display: none !important; } }
        @media (min-width: 768px)   { .hide-gte-sm  { display: none !important; } }
        @media (min-width: 1024px)  { .hide-gte-md  { display: none !important; } }
        @media (min-width: 1280px)  { .hide-gte-lg  { display: none !important; } }
        @media (min-width: 1536px)  { .hide-gte-xl  { display: none !important; } }

        .htmx-indicator {
            opacity: 0;
            transition: opacity 500ms ease-in;
        }
        .htmx-request .htmx-indicator {
            opacity: 1;
        }
        #search_form {
            z-index: 4000;
        }
        #details_map {
            width: 100%;
            height: 500px;
        }
        
        .toast {
          background: var(--pico-background-color);
          color: var(--pico-color);
          border: 1px solid var(--pico-muted-border-color, #ccc);
          padding: 0.75rem 1rem;
          margin-bottom: 0.5rem;
          border-radius: 0.375rem;
          box-shadow: 0 2px 6px rgba(0,0,0,0.1);
          opacity: 0;
          transform: translateY(-10px);
          transition: opacity 0.3s ease, transform 0.3s ease;
          font-size: 0.9rem;
          max-width: 300px;
        }
        .toast.show {
          opacity: 1;
          transform: translateY(0);
        }
        .toast.Normal {
          border-left: 4px solid var(--pico-primary, #1fa3ec);
        }
        .toast.Failed {
          border-left: 4px solid #d9534f;
        }
        .toast.Warning {
          border-left: 4px solid #f0ad4e;
        }

        /* Page Specific CSS */{% block css %}
        {% endblock %}/* END OF Page Specific CSS */


    </style>
    
    <!-- Page Specific head content -->{% block head %}
    {% endblock %}    <!-- END OF Page Specific head content -->

</head>

<body>
    <div id="toast-container" style="position: fixed; top: 1rem; right: 1rem; z-index: 9999;"></div>

    <div id="header" class="container" style="padding: calc(var(--pico-spacing)); margin-bottom: calc(var(--pico-spacing)); border-bottom: var(--pico-border-width) solid var(--pico-form-element-border-color);">  
        {% set site = site_config.get("site", {}) %}
        <div style="text-align:center">
            <strong>{{ site.get("title", "") }} {{ site.get("domain", "") }}</strong>
        </div>
        <div style="text-align: center;">
            {{ site.get("message", "") }}
        </div>

        <div style="text-align:center;">
            {% if site.get("map") == "True" %}<a href="/map">Live Map</a>{% endif %}
            {% if site.get("nodes") == "True" %} | <a href="/nodelist">Nodes</a>{% endif %}
            {% if site.get("graphs") == "True" %} | <a href="/nodegraph">Mesh Graphs</a>{% endif %}
            {% if site.get("conversations") == "True" %} | <a href="/chat">Conversations</a>{% endif %}
            {% if site.get("net") == "True" %} | <a href="/net">Weekly Net</a>{% endif %}
            {% if site.get("stats") == "True" %} | <a href="/stats">Stats</a>{% endif %}
            {% if site.get("top") == "True" %} | <a href="/top">Top Traffic</a>{% endif %}
            {% if site.get("everything") == "True" %} | <a href="/firehose">All Packets</a>{% endif %}
        </div>
    </div>            
    {% block body %}{% endblock %}

    <div id="footer" class="container" style="text-align: center; padding: calc(var(--pico-spacing)); margin-top: calc(var(--pico-spacing)); border-top: var(--pico-border-width) solid var(--pico-form-element-border-color);">  
        {% if site.get("external_footer_links", [])|length > 0 %}
        <div style="margin: calc(var(--pico-spacing)/2) 0;">
          {% for l in site.get("external_footer_links", []) %}
            {{ "| " if not loop.first }}<a href="{{l[1]}}" target="_blank">{{l[0]}}</a>
          {% endfor %}
        </div>        
        {% endif %}
      
        {% include "message_form.html" %}
        {% include "search_form.html" %}
        <div>
          Visit <strong><a href="https://github.com/danricho/meshview" target="_blank">Meshview</a></strong> on Github.<br />
          <small>v.{{ SOFTWARE_RELEASE | default("unknown") }}</small>
        </div>

    </div>

</body>

<script>
      
function showToast(message, type = "Warning", duration = 5000) {
  const container = document.getElementById("toast-container");

  const toast = document.createElement("div");
  toast.className = `toast ${type}`;
  toast.innerHTML = message;

  container.appendChild(toast);

  // Force reflow to enable animation
  requestAnimationFrame(() => {
    toast.classList.add("show");
  });

  // Auto-remove
  setTimeout(() => {
    toast.classList.remove("show");
    setTimeout(() => toast.remove(), 300);
  }, duration);
}

</script>

</html>
